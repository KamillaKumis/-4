import os
from PIL import Image
from ultralytics import YOLO
import easyocr

best_model = YOLO("best.pt")
reader = easyocr.Reader(['en'])


inputfolder = 'images'
outputfolder = 'outputresults'


for filename in os.listdir(inputfolder):
    if filename.lower().endswith(('.png', '.jpg', '.jpeg')):
        source = os.path.join(inputfolder, filename)

        results = best_model.predict(source, imgsz=320, conf=0.7)

        for i, result in enumerate(results):
            im_array = result.plot()
            im = Image.fromarray(im_array[..., ::-1])
            output_path = os.path.join(outputfolder, f'results_{filename}')
            im.save(output_path)
